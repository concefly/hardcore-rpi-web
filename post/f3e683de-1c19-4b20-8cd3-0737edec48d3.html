<h1>Test</h1>

<h1>教你外网登录树莓派远程桌面</h1>

<article>
  <p>在上期的<a href="https://zhuanlan.zhihu.com/p/98080664">教你从零开始连接树莓派远程桌面</a>中，介绍了如何在同一局域网下登录树莓派远程桌面。但如果你出门在外，在外网环境，比如在公司或学校，还能不能登录？答案是肯定的。</p>
<p>这篇文章就来教大家，如何外网登录树莓派远程桌面。</p>
<h1 id="配置路由器端口转发">配置路由器端口转发</h1>
<p>我们知道，VNC viewer 需要有树莓派的 IP 地址才能登录远程桌面。当你在外网环境时，如果不做处理，你只能访问到宽带拨号分配给路由器的 IP，而不是树莓派的。这时候就要配置路由器的“端口转发规则”，让<strong>外网 VNC Viewer 能访问到树莓派的 IP 地址</strong>。</p>
<p>首先，进入路由器管理后台，找到“端口转发”设置界面，配置 <code>5900</code> 端口转发（这里假设路由器的外网 IP 是 <code>100.100.100.100</code>，树莓派的内网 IP 是 <code>192.168.1.123</code>）。至于为什么是 5900 端口，这是因为树莓派上运行的 VNC Server 的默认端口号是 5900，所以配置这个端口就行。原理如下图所示：</p>
<p><img src="/media/15801465197761/15801961106927.jpg" alt=""></p>
<p>配置完这个后，外网所有到 <code>100.100.100.100:5900</code> 的流量都会被路由器转发到 <code>192.168.1.123:5900</code>。</p>
<p>当然，不同品牌的路由器的“端口转发”设置可能不一样，要灵活处理。这里贴一张我的 Linksys 路由器端口转发配置的截图：</p>
<p><img src="/media/15801465197761/15801957785074.jpg" alt="-w450"></p>
<h1 id="vnc-viewer-外网登录树莓派远程桌面">VNC Viewer 外网登录树莓派远程桌面</h1>
<p>如果你已经看过 <a href="https://zhuanlan.zhihu.com/p/98080664">教你从零开始连接树莓派远程桌面</a> ，那这一步就非常简单了。</p>
<p>新建 VNC 连接，然后 VNC Server 的 IP 地址填路由器的外网 IP，点“确定”即可。</p>
<p><img src="/media/15801465197761/15801966778251.jpg" alt="-w552"></p>
<h1 id="注意事项">注意事项</h1>
<ul>
<li>路由器的外网 IP 由宽带拨号动态分配，可能会变化，所以如果突然发现连不上远程桌面，首先看下外网 IP 是不是已经变了。</li>
<li>远程桌面端口暴露到外网后，最好修改树莓派登录密码，不要再继续使用默认的 <code>raspberry</code>，否则会有安全风险。</li>
</ul>
<p><img src="/media/15801465197761/15801973014421.jpg" alt="-w539"></p>
<h1 id="参考资料">参考资料</h1>
<ul>
<li><a href="https://help.realvnc.com/hc/en-us/articles/360002253878-Configuring-VNC-Connect-Using-Parameters">Configuring VNC Connect Using Parameters – RealVNC Help Center</a></li>
<li><a href="https://help.realvnc.com/hc/en-us/articles/360002313518-vncserver-x11-Man-Page">vncserver-x11 Man Page – RealVNC Help Center</a></li>
<li><a href="https://www.192ly.com/qiu-zhu/r-dkys.html">路由器端口映射怎么设置?_路由器虚拟服务器设置方法-192路由网</a></li>
</ul>

</article>